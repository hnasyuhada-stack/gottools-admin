<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin Management â€“ GotTools</title>
  <link rel="stylesheet" href="css/style.css">
</head>

<body>
<div class="layout">

  <!-- SIDEBAR (reuse yours) -->

  <main class="main">
    <header class="topbar">
      <h1>Admin Management</h1>
    </header>

    <section class="card">
      <table class="report-table">
        <thead>
          <tr>
            <th>Name</th>
            <th>Email</th>
            <th>Role</th>
            <th>Status</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody id="adminTable"></tbody>
      </table>
    </section>
  </main>
</div>

<script type="module">
  import { requireSuperAdmin } from "./js/auth-guard.js";
  import { auth, db } from "./js/firebase-config.js";
  import { collection, getDocs, doc, updateDoc } 
    from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

  requireSuperAdmin();

  const table = document.getElementById("adminTable");

  async function loadAdmins() {
    const snap = await getDocs(collection(db, "admins"));
    table.innerHTML = "";

    snap.forEach(d => {
      const a = d.data();
      const tr = document.createElement("tr");

      tr.innerHTML = `
        <td>${a.name || "-"}</td>
        <td>${d.id}</td>
        <td>${a.role}</td>
        <td>${a.active ? "Active" : "Disabled"}</td>
        <td>
          <button onclick="toggle('${d.id}', ${a.active})">
            ${a.active ? "Disable" : "Enable"}
          </button>
        </td>
      `;
      table.appendChild(tr);
    });
  }

  window.toggle = async (uid, active) => {
    await updateDoc(doc(db, "admins", uid), {
      active: !active,
      updatedAt: new Date()
    });
    loadAdmins();
  };

  loadAdmins();
</script>

</body>
</html>
